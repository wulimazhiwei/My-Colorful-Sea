# MySQL历史数据清理评估
# 以Android CallFree应用的CREDIT表为例：

一、为何清理历史数据
  ①占用大量磁盘空间
  ②数据量大（1760w条数据），未使用分区，业务效率存在问题
  ③重构此表，建立分区表，便于维护
  
二、如何清理
  ①创建一个和原表表结构一致的新表，按天建立分区。
  ②rename表名，将新表投入使用，旧表暂停。并备份旧表。
  ③将旧表中最近一周的数据（约62w条数据）填充至新表中，耗时估计5分钟。
  ④陆续将最近5个月的数据导入至新表中。耗时无法预估。
  ⑤删除旧表。
  
三、有何影响
  ①该表是挣取金币以及花钱购买金币的明细表，涉及的接口有看广告、看视频、任务墙、新用户赠送、推送赠送和获取充值记录这些接口。
  ②其中看广告、看视频、任务墙、新用户赠送、推送赠送接口中涉及用户最近24小时内获取次数或者金额的限制或者告警内容；
    获取充值记录涉及用户最近500次充值记录的查询。
  ③因此，如果对表进行上述处理，在这5分钟内，看广告、看视频、任务墙、新用户赠送、推送赠送接口中涉及的用户最近24小时内获取次数或者金额的限制或者
  告警内容会无法准确把控，造成多送金币的情况。  获取充值记录涉及的用户最近500次充值记录的查询，无法查询到历史记录，最近一周的数据导入后，最近一周
  之前的历史记录无法查询，直到最近5个月的数据导入至新表中之后可以查询最近5个月的记录，最近5个月以前的数据无法查询。
